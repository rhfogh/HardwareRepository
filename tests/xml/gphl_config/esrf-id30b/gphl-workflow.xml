<object class="GphlWorkflow">

    <!-- GPHL configuration subdirectory
         (will be searched for in HardwareObjects config xml directories-->
    <gphl_config_subdir>gphl_config/esrf-id30b</gphl_config_subdir>
    <!-- GPHL test samples subdirectory (for simcal test input)
         (will be searched for in HardwareObjects config xml directories-->
    <gphl_samples_subdir>gphl_config/test_samples</gphl_samples_subdir>
    <!-- Subdirectory under Session.get_process_directory() for GPhL persistence data-->
    <gphl_subdir>GPHL</gphl_subdir>

    <!-- List of supported workflows, with options for each -->
    <workflows>
        <TranslationalCalibration>
            <application>co.gphl.wf.workflows.WFTransCal</application>
            <strategy_type>transcal</strategy_type>
            <documentation>Translational calibration.
                Designed for use by beamline personnel.
                Will produce a series of goniostat positions compatible with
                the inbuilt collision checker, move the goniostat to each
                position, and ask for centring.
            </documentation>
            <options>
                <!-- Name for translation calibration output -->
                <calibration>Transcal</calibration>
                <!-- file: File containing settings of rotation axes for calibration -->
                <!-- The name is the relative path from the Repository directory -->
                <!-- grid: Grid definition [axis_name:start:end:step], slowest-varying to fastest varying -->
                <!-- EITHER file OR grid must be set. NBNB REDO! -->
                <file>gphl_config/esrf-id30b/transcal_2stage.json</file>
                <!--&lt;!&ndash; copy calibration result to configuration directory, replacing previous value &ndash;&gt;-->
                <updateblconfig/>
                <!-- updateconfig option, automaticallly updates entire configuration -->
                <!--<grid>grid_axes_spec</grid>-->
                <!-- Path of file to dump persisted new version of instrumentation configuration. 
		     For debugging/diagnostic purposes only. OPTIONAL-->
                <!-- <instcfgout>/MXCuBE/mxcube/gphl_transcal_out.nml</instcfgout> -->
            </options>
        </TranslationalCalibration>

        <DiffractometerCalibration>
            <application>co.gphl.wf.workflows.WFDiffractCal</application>
            <strategy_type>diffractcal</strategy_type>
            <documentation>Diffractometer calibration.
                Designed for use by beamline personnel.
            </documentation>
            <!-- Default wavelengths (in A) and their roles -->
            <options>
                <!-- Name of initial strategy from library to use -->
                <strategy>DiffractCal_ex</strategy>
                <!-- Working subdirectory for workflow-side application data-->
                <!-- <appdir>calculations</appdir> -->
                <!-- Name for diffractometer calibration output -->
                <calibration>Diffractcal</calibration>
                <!-- Path of file to dump persisted new version of instrumentation configuration. 
		     For debugging/diagnostic purposes only. OPTIONAL-->
                <!-- <instcfgout>/MXCuBE/mxcube/gphl_diffractcal_out.nml</instcfgout> -->
                <!-- Pattern name for characterisation collections - used for all data here-->
                <charpattern>multiorientation</charpattern>
                <!--&lt;!&ndash; copy calibration result to configuration directory, replacing previous value &ndash;&gt;-->
		<!-- Doesn't work at the ESRF because the workflow beamline configuration directory
		     is not accessible from mxproc -->
                <!--<updateblconfig/>-->
            </options>
        </DiffractometerCalibration>

        <DiffractometerCalibration_short>
            <application>co.gphl.wf.workflows.WFDiffractCal</application>
            <strategy_type>diffractcal_short</strategy_type>
            <documentation>Diffractometer calibration.
                Designed for use by beamline personnel.
            </documentation>
            <!-- Default wavelengths (in A) and their roles -->
            <options>
                <!-- Name of initial strategy from library to use -->
                <strategy>DiffractCal</strategy>
                <!-- Working subdirectory for workflow-side application data-->
                <!-- <appdir>calculations</appdir> -->
                <!-- Name for diffractometer calibration output -->
                <calibration>Diffractcal</calibration>
                <!-- Path of file to dump persisted new version of instrumentation configuration. 
		     For debugging/diagnostic purposes only. OPTIONAL-->
                <!-- <instcfgout>/MXCuBE/mxcube/gphl_diffractcal_out.nml</instcfgout> -->
                <!-- Pattern name for characterisation collections - used for all data here-->
                <charpattern>multiorientation</charpattern>
                <!--&lt;!&ndash; copy calibration result to configuration directory, replacing previous value &ndash;&gt;-->
		<!-- Doesn't work at the ESRF because the workflow beamline configuration directory
		     is not accessible from mxproc -->
                <!--<updateblconfig/>-->
            </options>
        </DiffractometerCalibration_short>

        <NativeData_fast>
            <application>co.gphl.wf.workflows.WFSimpleCharToProcessing</application>
            <strategy_type>native_fast</strategy_type>
            <documentation>
                Single wavelength data acquisition, strategy for native data collectino
                Includes initial characterisation and complete collection.
                Fast strategy, 1 sweep (2 for triclinic), chiMax = 20deg
            </documentation>
            <!-- Default wavelengths (in A) and their roles -->
            <beam_energies>
                <beam_energy>
                    <role>Acquisition</role>
                    <!-- beamline energies in keV -->
                    <value>12.7</value>
                </beam_energy>
            </beam_energies>
            <options>
                <!-- Name of initial strategy from library to use -->
                <strategy>InitialCharacterisation</strategy>
                <!-- Working subdirectory for workflow-side application data-->
                <!-- <appdir>calculations</appdir> -->
                <!-- Pattern name for inverse-beam collections -->
                <ibpattern>ib_interleaved</ibpattern>
                <!-- Pattern name for non-inverse-beam collections -->
                <pattern>interleaved</pattern>
                <!-- NBNB replace later -->
                <!-- Pattern name for characterisation collections -->
                <charpattern>generic</charpattern>
                <!-- Default prefix - will be overwritten from user input -->
                <prefix>gphl_data</prefix>
            </options>
        </NativeData_fast>

        <NativeData_medium>
            <application>co.gphl.wf.workflows.WFSimpleCharToProcessing</application>
            <strategy_type>native_medium</strategy_type>
            <documentation>
                Single wavelength data acquisition, strategy for native data collectino
                Includes initial characterisation and complete collection.
                Medium strategy, 2 sweeps (3 for triclinic), chiMax = 35deg
            </documentation>
            <!-- Default wavelengths (in A) and their roles -->
            <beam_energies>
                <beam_energy>
                    <role>Acquisition</role>
                    <!-- beamline energies in keV -->
                    <value>12.7</value>
                </beam_energy>
            </beam_energies>
            <options>
                <!-- Name of initial strategy from library to use -->
                <strategy>InitialCharacterisation</strategy>
                <!-- Working subdirectory for workflow-side application data-->
                <!-- <appdir>calculations</appdir> -->
                <!-- Pattern name for inverse-beam collections -->
                <ibpattern>ib_interleaved</ibpattern>
                <!-- Pattern name for non-inverse-beam collections -->
                <pattern>interleaved</pattern>
                <!-- NBNB replace later -->
                <!-- Pattern name for characterisation collections -->
                <charpattern>generic</charpattern>
                <!-- Default prefix - will be overwritten from user input -->
                <prefix>gphl_data</prefix>
            </options>
        </NativeData_medium>

        <NativeData_optimal>
            <application>co.gphl.wf.workflows.WFSimpleCharToProcessing</application>
            <strategy_type>native_optimal</strategy_type>
            <documentation>
                Single wavelength data acquisition, strategy for native data collectino
                Includes initial characterisation and complete collection.
                Strategy for optimal distribution of redundancy,
                3-4 sweeps. Uses full kappa range.
                Defaults to medium strategy for sixfold and cubic symmetries.
            </documentation>
            <!-- Default wavelengths (in A) and their roles -->
            <beam_energies>
                <beam_energy>
                    <role>Acquisition</role>
                    <!-- beamline energies in keV -->
                    <value>12.7</value>
                </beam_energy>
            </beam_energies>
            <options>
                <!-- Name of initial strategy from library to use -->
                <strategy>InitialCharacterisation</strategy>
                <!-- Working subdirectory for workflow-side application data-->
                <!-- <appdir>calculations</appdir> -->
                <!-- Pattern name for inverse-beam collections -->
                <ibpattern>ib_interleaved</ibpattern>
                <!-- Pattern name for non-inverse-beam collections -->
                <pattern>interleaved</pattern>
                <!-- NBNB replace later -->
                <!-- Pattern name for characterisation collections -->
                <charpattern>generic</charpattern>
                <!-- Default prefix - will be overwritten from user input -->
                <prefix>gphl_data</prefix>
            </options>
        </NativeData_optimal>

        <SingleWavelengthAcquisition>
            <application>co.gphl.wf.workflows.WFSimpleCharToProcessing</application>
            <strategy_type>phasing</strategy_type>
            <documentation>
                Single wavelength data acquisition, optimised for phasing.
                Includes initial characterisation and complete collection
            </documentation>
            <!-- Default wavelengths (in A) and their roles -->
            <beam_energies>
                <beam_energy>
                    <role>Acquisition</role>
                    <!-- beamline energies in keV -->
                    <value>12.7</value>
                </beam_energy>
            </beam_energies>
            <options>
                <!-- Name of initial strategy from library to use -->
                <strategy>InitialCharacterisation</strategy>
                <!-- Working subdirectory for workflow-side application data-->
                <!-- <appdir>calculations</appdir>-->
                <!-- Pattern name for inverse-beam collections -->
                <ibpattern>ib_interleaved</ibpattern>
                <!-- Pattern name for non-inverse-beam collections -->
                <pattern>interleaved</pattern>
                <!-- NBNB replace later -->
                <!-- Pattern name for characterisation collections -->
                <charpattern>generic</charpattern>
                <!-- Default prefix - will be overwritten from user input -->
                <prefix>gphl_data</prefix>
            </options>
        </SingleWavelengthAcquisition>

        <TwoWavelengthMAD>
            <application>co.gphl.wf.workflows.WFSimpleCharToProcessing</application>
            <strategy_type>phasing</strategy_type>
            <documentation>
                Two-wavelength MAD data acquisition, optimised for phasing.
                Includes initial characterisation and complete collection
            </documentation>
            <!-- Default wavelengths (in A) and their roles -->
            <beam_energies>
                <beam_energy>
                    <role>Peak</role>
                    <!-- beamline energies in keV -->
                    <value>12.7</value>
                </beam_energy>
                <beam_energy>
                    <role>Remote</role>
                    <!-- beamline energies in keV -->
                    <value>12.72</value>
                </beam_energy>
            </beam_energies>
            <options>
                <!-- Name of initial strategy from library to use -->
                <strategy>InitialCharacterisation</strategy>
                <!-- Working subdirectory for workflow-side application data-->
                <!-- <appdir>calculations</appdir>-->
                <!-- Pattern name for inverse-beam collections -->
                <ibpattern>ib_interleaved</ibpattern>
                <!-- Pattern name for non-inverse-beam collections -->
                <pattern>interleaved</pattern>
                <!-- NBNB replace later -->
                <!-- Pattern name for characterisation collections -->
                <charpattern>generic</charpattern>
                <!-- Default prefix - will be overwritten from user input -->
                <prefix>gphl_data</prefix>
            </options>
        </TwoWavelengthMAD>

        <ThreeWavelengthMAD>
            <application>co.gphl.wf.workflows.WFSimpleCharToProcessing</application>
            <strategy_type>phasing</strategy_type>
            <documentation>
                Three-wavelength MAD data acquisition, optimised for phasing.
                Includes initial characterisation and complete collection
            </documentation>
            <!-- Default wavelengths (in A) and their roles -->
            <beam_energies>
                <beam_energy>
                    <role>Peak</role>
                    <!-- beamline energies in keV -->
                    <value>12.7</value>
                </beam_energy>
                <beam_energy>
                    <role>Rising_Inflection</role>
                    <!-- beamline energies in keV -->
                    <value>12.69</value>
                </beam_energy>
                <beam_energy>
                    <role>Falling_Inflection</role>
                    <!-- beamline energies in keV -->
                    <value>12.71</value>
                </beam_energy>
            </beam_energies>
            <options>
                <!-- Name of initial strategy from library to use -->
                <strategy>InitialCharacterisation</strategy>
                <!-- Working subdirectory for workflow-side application data-->
                <!-- <appdir>calculations</appdir>-->
                <!-- Pattern name for inverse-beam collections -->
                <ibpattern>ib_interleaved</ibpattern>
                <!-- Pattern name for non-inverse-beam collections -->
                <pattern>interleaved</pattern>
                <!-- NBNB replace later -->
                <!-- Pattern name for characterisation collections -->
                <charpattern>generic</charpattern>
                <!-- Default prefix - will be overwritten from user input -->
                <prefix>gphl_data</prefix>
            </options>
        </ThreeWavelengthMAD>
    </workflows>



    <!-- Parameters for the command-line invocation of the workflow application-->
    <!-- These are unlikely to need changing - except for maybe wfprefix -->

    <!-- Java invocation properties - syntax is e.g. '-Dfile.encoding=UTF-8' -->
    <invocation_properties>
        <file.encoding>UTF-8</file.encoding>
    </invocation_properties>

    <!-- Properties common to workflows - syntax e.g. '-Dfile.encoding=UTF-8'-->
    <!-- Syntax as for invocation properties, but located differently-->
    <workflow_properties>
        <!-- NB the following should be moving away, to a simcal-specific setup file -->
        <!-- Dummy sample properties: choose values for these to make the
        predictions for the characterisation strategy look reasonable (they
        have no scientific basis, and are not used for any scientific purpose). -->
        <co.gphl.wf.simcal_predict.b_wilson>26.0</co.gphl.wf.simcal_predict.b_wilson>
        <co.gphl.wf.simcal_predict.cell_dim_sd_scale>1.5e-3</co.gphl.wf.simcal_predict.cell_dim_sd_scale>
        <co.gphl.wf.simcal_predict.mosaicity>0.2</co.gphl.wf.simcal_predict.mosaicity>
        <!-- Uncomment this to disable stratcal's collision checking ->
        <co.gphl.wf.stratcal.collision_mode>2</co.gphl.wf.stratcal.collision_mode>
        -->
    </workflow_properties>

    <!--  Workflow options common to all workflows - can be overridden for individual workflows-->
    <workflow_options>
        <!-- URL for beamline connection, as seen from the workflow application -->
        <beamline>py4j::</beamline>
        <!-- Location of persistence layer (workflow application data files -->
        <!-- The main data file is : -->
        <!-- Session.get_process_directory()/<gphl_subdir>/<persist.xml -->
        <persistname>persistence</persistname>
        <!-- Workflow enactment prefix  OPTIONAL - if set to e.g. 'wfx', data
        for successive workflow runs will be stored in 'wfx_1, ,wfx_2, ... -->
        <wfprefix>gphl_wf_</wfprefix>
    </workflow_options>

</object>
